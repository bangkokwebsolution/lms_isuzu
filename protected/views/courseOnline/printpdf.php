<style type="text/css">
p { 	text-align: justify; margin-bottom: 4pt; margin-top:0pt;  }

table {font-family: DejaVuSansCondensed; font-size: 9pt; line-height: 1.2;
	margin-top: 2pt; margin-bottom: 5pt;
	border-collapse: collapse;  }

thead {	font-weight: bold; vertical-align: bottom; }
tfoot {	font-weight: bold; vertical-align: top; }
thead td { font-weight: bold; }
tfoot td { font-weight: bold; }

thead td, thead th, tfoot td, tfoot th { font-variant: small-caps; }

.headerrow td, .headerrow th { background-gradient: linear #b7cebd #f5f8f5 0 1 0 0.2;  }
.footerrow td, .footerrow th { background-gradient: linear #b7cebd #f5f8f5 0 1 0 0.2;  }

th {	font-weight: bold; 
	vertical-align: top; 
	text-align:left; 
	padding-left: 2mm; 
	padding-right: 2mm; 
	padding-top: 0.5mm; 
	padding-bottom: 0.5mm; 
 }

td {	
	padding-left: 2mm; 
	text-align:center; 
	padding-right: 2mm; 
	padding-top: 0.5mm; 
	padding-bottom: 0.5mm;
	height: 35px;
 }

th p { text-align: left; margin:0pt;  }
td p { text-align: left; margin:0pt;  }

table.widecells td {
	padding-left: 5mm;
	padding-right: 5mm;
}
table.tallcells td {
	padding-top: 3mm;
	padding-bottom: 3mm; 
}

hr {	width: 70%; height: 1px; 
	text-align: center; color: #999999; 
	margin-top: 8pt; margin-bottom: 8pt; }

a {	color: #000066; font-style: normal; text-decoration: underline; 
	font-weight: normal; }

ul {	text-indent: 5mm; margin-bottom: 9pt; }
ol {	text-indent: 5mm; margin-bottom: 9pt; }

pre { font-family: DejaVuSansMono; font-size: 9pt; margin-top: 5pt; margin-bottom: 5pt; }

h1 {	font-weight: normal; font-size: 26pt; color: #000066; 
	font-family: DejaVuSansCondensed; margin-top: 18pt; margin-bottom: 6pt; 
	border-top: 0.075cm solid #000000; border-bottom: 0.075cm solid #000000; 
	text-align: ; page-break-after:avoid; }
h2 {	font-weight: bold; font-size: 12pt; color: #000066; 
	font-family: DejaVuSansCondensed; margin-top: 6pt; margin-bottom: 6pt; 
	border-top: 0.07cm solid #000000; border-bottom: 0.07cm solid #000000; 
	text-align: ;  text-transform:uppercase; page-break-after:avoid; }
h3 {	font-weight: normal; font-size: 26pt; color: #000000; 
	font-family: DejaVuSansCondensed; margin-top: 0pt; margin-bottom: 6pt; 
	border-top: 0; border-bottom: 0; 
	text-align: ; page-break-after:avoid; }
h4 {	font-weight: ; font-size: 13pt; color: #9f2b1e; 
	font-family: DejaVuSansCondensed; margin-top: 10pt; margin-bottom: 7pt; 
	font-variant: small-caps;
	text-align: ;  margin-collapse:collapse; page-break-after:avoid; }
h5 {	font-weight: bold; font-style:italic; ; font-size: 11pt; color: #000044; 
	font-family: DejaVuSansCondensed; margin-top: 8pt; margin-bottom: 4pt; 
	text-align: ;  page-break-after:avoid; }
h6 {	font-weight: bold; font-size: 9.5pt; color: #333333; 
	font-family: DejaVuSansCondensed; margin-top: 6pt; margin-bottom: ; 
	text-align: ;  page-break-after:avoid; }

.breadcrumb {
	text-align: right; font-size: 8pt; font-family: DejaVuSerifCondensed; color: #666666;
	font-weight: bold; font-style: normal; margin-bottom: 6pt; }

.evenrow td, .evenrow th { background-color: #f5f8f5; } 
.oddrow td, .oddrow th { background-color: #e3ece4; } 

.bpmTopic {	background-color: #e3ece4; }
.bpmTopicC { background-color: #e3ece4; }
.bpmNoLines { background-color: #e3ece4; }
.bpmNoLinesC { background-color: #e3ece4; }
.bpmClear {		}
.bpmClearC { text-align: center; }
.bpmTopnTail { background-color: #e3ece4; topntail: 0.02cm solid #495b4a;}
.bpmTopnTailC { background-color: #e3ece4; topntail: 0.02cm solid #495b4a;}
.bpmTopnTailClear { topntail: 0.02cm solid #495b4a; }
.bpmTopnTailClearC { topntail: 0.02cm solid #495b4a; }

.bpmTopicC td, .bpmTopicC td p { text-align: center; }
.bpmNoLinesC td, .bpmNoLinesC td p { text-align: center; }
.bpmClearC td, .bpmClearC td p { text-align: center; }
.bpmTopnTailC td, .bpmTopnTailC td p { text-align: center;  }
.bpmTopnTailClearC td, .bpmTopnTailClearC td p {  text-align: center;  }

.pmhMiddleCenter { text-align:center; vertical-align:middle; }
.pmhMiddleRight {	text-align:right; vertical-align:middle; }
.pmhBottomCenter { text-align:center; vertical-align:bottom; }
.pmhBottomRight {	text-align:right; vertical-align:bottom; }
.pmhTopCenter {	text-align:center; vertical-align:top; }
.pmhTopRight {	text-align:right; vertical-align:top; }
.pmhTopLeft {	text-align:left; vertical-align:top; }
.pmhBottomLeft {	text-align:left; vertical-align:bottom; }
.pmhMiddleLeft {	text-align:left; vertical-align:middle; }

.infobox { margin-top:10pt; background-color:#DDDDBB; text-align:center; border:1px solid #880000; }

.bpmTopic td, .bpmTopic th  {	border-top: 1px solid #FFFFFF; }
.bpmTopicC td, .bpmTopicC th  {	border-top: 1px solid #FFFFFF; }
.bpmTopnTail td, .bpmTopnTail th  {	border-top: 1px solid #FFFFFF; }
.bpmTopnTailC td, .bpmTopnTailC th  {	border-top: 1px solid #FFFFFF; }
</style>

<div style="text-align: center; font-weight: bold">
	<img src="http://www.cpdland.com/images/print/logo.png" alt="Logo"/>
	<br>
	<font style="font-size: 20px;">บริษัท ซีพีดีแลนด์ (เมืองไทย) จำกัด</font>
</div>
<div style="font-size: 16px; line-height: 1.8; font-weight: bold; text-align: center;">
	<?php $SettingAll = Helpers::lib()->SetUpSetting(); ?>
	รหัสสถาบัน <?php echo $SettingAll['SITE_INSTITUTION']; ?> เลขประจำตัวผู้เสียภาษีอากร 0105556015189
	<br>
	เลขที่ 1 ชั้น 3 ห้อง 319 ซอยสุขสวัสดิ์ 33/1 ถนนสุขสวัสดิ์ แขวง/เขตราษฎร์บูรณะ กรุงเทพมหานคร 10140
</div>
<br><br>

<?php  
//CPD = 1
//CDA = 2
if($model->CourseOnlines->course_type == 1)
{
	if(isset($model->Profiles->acc_number)){ $CheckNumberType = $model->Profiles->acc_number; }else{ $CheckNumberType = '-'; }
	$CheckType =  "เลขที่ผู้ทำบัญชี";
}
else
{
	if(isset($model->Profiles->cpa_number)){ $CheckNumberType = $model->Profiles->cpa_number; }else{ $CheckNumberType = '-'; }
	$CheckType = "เลขที่ผู้สอบบัญชี";
}
?>

<div style="font-size: 16px;  text-align: right; width: 100%;">
	เลขที่ <?php echo substr(date("Y")+543,2,4).''.sprintf("%05d",$model->passcours_id); ?>
</div>
<br><br>

<div style="font-size: 18px; text-align: center;text-decoration:underline;font-weight: bold;">
	 หนังสือรับรอง
</div>
<br>

<div style="font-size: 15px; text-align: center;line-height: 2; margin-left:0px;">
	 ผู้เข้ารับการอบรม คุณ<?php echo $model->NameUser;?> เลขที่บัตรประชาชน <?php echo $model->Profiles->idcard;?> / <?php echo $CheckType; ?> <?php echo $CheckNumberType; ?>
</div>

<div style="font-size: 15px; text-align: center; line-height: 2;">
	ได้เข้ารับการอบรมเก็บชั่วโมง<?php echo $CheckType;?>ผ่านเครือข่ายอินเตอร์เน็ต (E-Learning) ครบตามหลักเกณฑ์ที่ได้<br>
	กำหนดอ้างถึงหนังสือ<?php echo $model->CourseOnlines->course_refer; ?> เลขที่ <?php echo $model->CourseOnlines->course_book_number; ?> ลงวันที่ <?php echo ClassFunction::datethai($model->CourseOnlines->course_book_date);?>
</div>

<br>

<?php
$CheckDateEnd = array();
$lessonModel = Lesson::model()->findAll(array(
	'condition'=>'course_id=:course_id',
		'params'=>array(':course_id'=>$model->CourseOnlines->course_id)
));
foreach ($lessonModel as $key => $value){
	$user = Yii::app()->getModule('user')->user();
    $learnLesson = $user->learns(
        array(
            'condition'=>'lesson_id=:lesson_id',
            'order' => 'lesson_id desc',
            'params' => array(':lesson_id' => $value->id)
        )
    );
    foreach ($learnLesson as $keylearn => $valuelearn) {
    	$CheckDateEnd[] = $valuelearn->learn_date;
    }
}
?>
<table border="1" width="100%" style="font-size: 15px;">
	<tr>
		<td rowspan="2" align="center">รหัส / ชื่อหลักสูตรการอบรม</td>
		<td colspan="2">วันที่อบรม</td>
		<td colspan="2">การนับชั่วโมง</td>
	</tr>
	<tr>
		<td>เริ่ม</td>
		<td>สิ้นสุด</td>
		<td>บัญชี</td>
		<td>อื่นๆ</td>
	</tr>
	<tr>
		<td width="350" height="70">
			<p>รหัสหลักสูตร <?php echo $model->CourseOnlines->course_number;?></p>
			<br>
			<p><?php echo $model->CourseOnlines->course_title;?></p>
			<br>
			<p>วิทยากร <?php echo $model->CourseOnlines->teachers->teacher_name;?></p>
		</td>
		<!--date start--><td width="55"><font style="font-size: 14px;">
		<?php //echo ClassFunction::datePrint($CheckDateEnd[0]);//Org 
			$year_e = date('Y', strtotime($model->passcours_date))+543;
			echo date('d/m', strtotime($model->passcours_date)).'/'.$year_e;
		?></font>

		</td>
		<!--date end--><td width="55"><font style="font-size: 14px;">
		<?php //echo ClassFunction::datePrint($model->passcours_date);ssssss
			$year = date('Y', strtotime($CheckDateEnd[0]))+543;
			echo date('d/m', strtotime($CheckDateEnd[0])).'/'.$year;
		?></font></td>
		<td width="55"><?php if($model->CourseOnlines->course_hour != '') echo $model->CourseOnlines->course_hour; else echo '-'; ?></td>
		<td width="55"><?php if($model->CourseOnlines->course_other != '') echo $model->CourseOnlines->course_other; else echo '-'; ?></td>
	</tr>
</table>

<br>

<div style="text-align: center; font-size: 15px;line-height: 2;">
รายละเอียดหลักสูตรการอบรมที่อธิบดีได้ให้ความเห็นชอบ เมื่อวันที่ <?php echo ClassFunction::datethai($model->CourseOnlines->course_rector_date);?><br>
ขอรับรองว่าข้อความดังกล่าวข้างต้นถูกต้องตรงกับความจริงทุกประการ<br>
ให้ไว้  ณ  วันที่ <?php echo ClassFunction::datethai($model->passcours_date);?><br>
<br />
<br>

<img src="http://www.cpdland.com/images/print/signature10.jpg" height="58" /><br>
( นายวินัย  ศรีอรุณราช )<br>
กรรมการบริหาร
</div>

<br><br>

<?php if(!empty($model->CourseOnlines->course_note)) :?>
	<div style="text-align: left">
	หมายเหตุ :: <?php echo $model->CourseOnlines->course_note; ?>
	</div>
<?php endif; ?>